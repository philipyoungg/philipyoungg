//     ____  __    _ ___          __  __                        
//    / __ \/ /_  (_) (_)___      \ \/ /___  __  ______  ____ _ 
//   / /_/ / __ \/ / / / __ \      \  / __ \/ / / / __ \/ __ `/ 
//  / ____/ / / / / / / /_/ /      / / /_/ / /_/ / / / / /_/ /  
// /_/   /_/ /_/_/_/_/ .___/      /_/\____/\__,_/_/ /_/\__, /   
//                  /_/                               /____/    
// ------------------------------------------------------------ 
//       Product Design & Developement - philipyoungg.com       
// ------------------------------------------------------------ 


doctype html
html(lang='en')
  head
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width initial-scale=1.0, maximum-scale=1.0, user-scalable=no')
    meta(name="google-site-verification" content="8_jk4EKPuEDASp4cmS5SgZSNYpl-RxRyaJPO9jF5Pq8")
    meta(name='author' content='Philip Young')
    meta(name='author-website' content='philipyoungg.com')
    link(href='https://fonts.googleapis.com/css?family=Poppins:400,600,700|Inconsolata:400,700', rel='stylesheet')
    link(href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet')
    script(src='https://cdnjs.cloudflare.com/ajax/libs/instafeed.js/1.4.1/instafeed.min.js')
    script(src='https://cdn.rawgit.com/philipyoungg/external-link-to-new-tab/master/externalLinkToNewTab.min.js')
    link(rel='stylesheet' href='https://cdn.rawgit.com/philipyoungg/external-link-to-new-tab/master/externalLinkToNewTab.css')
    link(rel='stylesheet', href='https://cdnjs.cloudflare.com/ajax/libs/tachyons/4.6.2/tachyons.css')
    link(rel="stylesheet", href="/reset.css")
    link(rel="stylesheet", href="/main.css")
    title= public._data[current.path] ? public._data[current.path].title + " - Philip Young" : title + " - Philip Young"
    meta(name="description" content=description ? description : public._data.index.description)
  body.lh-copy.bg-mint
    // grid
    .fixed.cf.ph2.ph3-m.ph5-ns.grid.w-100.vh-100.absolute-horizontal-center
      .fl.w-50.w-third-m.replace.w-25-ns.ph2.ph3-ns.h-100
        .bl.b--black-05.h-100
      .fl.w-50.w-third-m.replace.w-25-ns.ph2.ph3-ns.h-100
        .bl.b--black-05.h-100
      .fl.w-50.w-third-m.replace.w-25-ns.ph2.ph3-ns.h-100
        .bl.b--black-05.h-100
      .fl.w-50.w-third-m.replace.w-25-ns.ph2.ph3-ns.h-100.br.b--black-05
        .bl.b--black-05.h-100
    .vs-section.pt4.pt5-ns
      #app
        !=partial('_shared/header')
        if (current.path[0] !== 'thoughts') 
          !=yield
        else
          .cf.center.ph2.ph3-m.ph5-ns.grid
            .fl.w-100.w-100-m.w-25-ns.ph2.ph3-ns.mb3.mb4-m.mb0-ns
              f5.b.mb1 Navigation
              != partial('_shared/nav')
            .fl.w-100.w-100-m.w-75-ns.ph2.ph3-ns.wow.fadeInUp
                h1.f3.f1-m.f-subheadline-ns.poppins.tracked-tight.mb3.mb4-ns
                  =current.path[1] === 'index' ? 'Thoughts' : title
          if (current.path[1] !== 'index')
            .cf.center.ph2.ph3-m.ph5-ns.grid.wow.fadeInUp
              .fl.w-100.w-100-m.w-25-ns.ph2.ph3-ns.h1.dn-m
              article.fl.w-100.w-100-m.w-75-ns.ph2.ph3-ns.mb4.mb5-ns.measure-wide
                !=yield
            !=partial('_shared/subscribe')
            .cf.ph3.ph4-m.ph5-ns.center.grid.mb4.mb5-ns.wow.fadeInUp
              .fl.w-100.w-25-ns.dn.dn-m.db.h1
              .fl.w-100.w-100-m.w-75-ns.ph2.ph3-ns.pv4
          !=partial('_shared/blog-excerpt')
        != partial('_shared/footer')
  script(src='https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.0/anime.min.js')
  script(src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.0/jquery.min.js')
  script.
    var splitWord = function(selector) {
      var title = document.querySelector(selector);
      title.style['whiteSpace'] = 'pre-wrap';
      title.style['opacity'] = 0;
      var words = title.textContent.split(' ')
      title.textContent = ''
      title.style['opacity'] = 1
      words.forEach(function(word){
        var span = document.createElement('span')
        var space = document.createElement('span')
        span.style['display'] = 'inline-block'
        span.style['opacity'] = 0
        span.textContent = word
        space.textContent = ' '
        title.appendChild(span)
        title.appendChild(space)
      })
    }
    
    $('#app').css({
      opacity: 0,
    })
    
    var loadingIn = anime.timeline({
      autoplay: false
    })
      .add({
        targets: '#app',
        easing: 'easeInOutQuad',
        opacity: [0, 1],
        translateX: [-10, 0],
        duration: 200,
      });
    
    var loadingOut = anime.timeline({
      autoplay: false
    })
      .add({
        targets: '#app',
        easing: 'easeInOutQuad',
        opacity: [1, 0],
        translateX: [0, 10],
        duration: 200,
      })
    loadingOut.finished.then(function(){
      window.location.href = window.location.href 
    })
    
    document.addEventListener('DOMContentLoaded', function(e){
      
      $('a').on('click', function(e){
        if (this.getAttribute('target') === '_blank') {
          return
        } else if (this.href) {
          e.preventDefault()
          loadingOut.play()
          history.pushState(null, null, this.href)
        } 
      })
      
      externalLinkToNewTab()
      
      setTimeout(function(){ // hack for smooth animation
        splitWord('h1')
        
        var title = {
          targets: 'h1 span',
          easing: 'easeInOutQuad',
          opacity: [0, 1],
          translateX: [-10, 0],
          duration: 300,
          delay: function(t, i) {
            return i * 50
          }
        }
        
        var article = {
          targets: 'article',
          easing: 'easeInOutQuad',
          opacity: [0, 1],
          translateX: [-20, 0],
          duration: 1000,
          offset: 150
        }
          
        var books = {
          targets: '.book',
          easing: 'easeInOutQuad',
          opacity: [0, 1],
          translateX: [-10, 0],
          duration: 300,
          delay: function(t, i) {
            return i * 100
          },
          offset: 150
        }
        
        var thoughts = {
          targets: '.thoughts',
          easing: 'easeInOutQuad',
          opacity: [0, 1],
          translateX: [-10, 0],
          duration: 300,
          delay: function(t, i) {
            return i * 100
          },
          offset: 150
        }
        
        var intro = {
          targets: '.intro',
          easing: 'easeInOutQuad',
          opacity: [0, 1],
          translateX: [-10, 0],
          duration: 300,
          delay: function(t, i) {
            return i * 100
          },
          offset: 150
        }
        
        var inquiry = {
          targets: '.inquiry',
          easing: 'easeInOutQuad',
          opacity: [0, 1],
          translateX: [-10, 0],
          duration: 500,
          offset: 150
        }
        
        var disclaimer = {
          targets: '.disclaimer',
          easing: 'easeInOutQuad',
          opacity: [0, 0.7],
          translateX: [-10, 0],
          duration: 300,
          offset: 400
        }
        
        $('.book').css({
          opacity: 0
        })
        $('.disclaimer').css({
          opacity: 0
        })
        $('.intro').css({
          opacity: 0
        })
        $('.thoughts').css({
          opacity: 0
        })
        $('article').css({
          opacity: 0
        })
        $('.inquiry').css({
          opacity: 0
        })
        
        var page = anime.timeline({
          autoplay: false,
        })
          .add(title)
          .add(books)
          .add(intro)
          .add(thoughts)
          .add(article)
          .add(inquiry)
          .add(disclaimer)
          
        loadingIn.play()
        page.play()
      }, 300)
    })
script(src='/tracker.js')
      
